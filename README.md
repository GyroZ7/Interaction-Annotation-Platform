# 交互标注与分析平台

这是一个基于 Gradio 的应用程序，旨在标注和分析图像序列上的用户交互路径。该工具有助于理解和评估给定任务流程中用户交互的效率。

## 功能

该平台分为两个主要选项卡：

### 1. 交互标注选项卡

- **加载图像序列**：从指定文件夹加载任务（一系列图像）。
- **多模式交互标注**：支持多种交互类型：
    - `click`（单击）
    - `multiclick`（多击，可指定点击次数）
    - `longpress`（长按，可指定持续时间）
    - `slide`（滑动，由起点和终点定义）
- **交互式标注**：直接在图像上点击以放置交互点。坐标将被归一化并记录下来。
- **导航和审查**：在序列中的图像之间轻松来回导航，以审查或修改标注。
- **导出标注**：将任务的已标注交互数据保存到 `interactions.json` 文件中，其中包括每张图像的交互类型、参数和定位坐标。

### 2. 加载计算选项卡

- **加载已标注数据**：加载和处理从标注选项卡生成的 `interactions.json` 文件。
- **简单路径分析**：
    - **可视化轨迹**：在图像上叠加显示完整的交互路径。
    - **距离图**：生成连续交互点之间欧几里得距离的图表，直观展示路径的一致性。
    - **统计指标**：计算并显示交互距离的均值和标准差等基本统计数据。
    - **操作质量得分**：计算一个分数，衡量当前操作对总路径长度的影响。正分表示缩短路径的高效交互，负分则表示拉长路径的低效交互。
- **比较分析**：
    - **并排比较**：选择两个不同的测试ID以比较它们的交互路径。
    - **比较图**：在单个图表上显示两个测试的距离图，以便于比较。
    - **比较统计**：显示两个测试的均值和标准差。

## 如何使用

### 1. 安装

使用 `requirements.txt` 文件安装所需的 Python 软件包。请确保您使用的至少是 Python 3.11.1（旧版本的gradio库可能未支持）。

```bash
pip3 install -r requirements.txt
```

### 2. 运行应用程序

通过运行以下命令启动 Gradio 应用程序：

```bash
python3 app.py
```

这将启动一个Web服务器，您可以通过提供的本地URL访问用户界面。

### 3. 标注工作流程

1.  导航到 **交互标注** 选项卡。
2.  从下拉菜单中选择一个测试文件夹。
3.  点击 **Start** 按钮加载图像序列。
4.  为每张图像选择所需的交互工具（`click`、`slide` 等）。
5.  在图像上点击以放置交互点。对于 `slide` 交互，您需要点击两次以定义起点和终点。
6.  使用 **Previous** 和 **Next** 按钮在图像之间导航。
7.  完成任务的所有交互标注后，点击 **Export Interaction** 按钮，将 `interactions.json` 文件保存在相应的测试文件夹中。

### 4. 分析工作流程

1.  导航到 **加载计算** 选项卡。
2.  选择您标注过的相同测试文件夹。
3.  点击 **Start** 按钮加载交互数据。
4.  **对于简单路径分析**：
    - 从第一个下拉菜单中选择一个 **Test ID**。
    - 轨迹、距离图和统计数据将自动显示。
    - 使用 **Previous** 和 **Next** 按钮查看交互路径中每一步的图表和分数变化。
5.  **对于比较分析**：
    - 选择一个主测试ID后，从第二个下拉菜单中选择另一个 **Test ID to Compare**。
    - 将生成比较图和相应的统计数据。

## 项目结构

```
.
├── app.py                  # 启动 Gradio UI 的主应用程序脚本
├── annotation_tab.py       # 标注选项卡的 UI 和逻辑
├── calculate_tab.py        # 计算/分析选项卡的 UI 和逻辑
├── utils.py                # 用于图像处理和数据处理的实用函数
├── requirements.txt        # Python 软件包依赖项
├── test_folder/            # 包含测试用例的目录
│   ├── [test_name_1]/
│   │   ├── test_img/
│   │   │   ├── 0001.png
│   │   │   └── ...
│   │   └── test_img_benchmark/
│   │       └── ...
│   └── ...
└── README.md               # 本文件
```